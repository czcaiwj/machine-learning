# 第3章 线性模型

## 一、基本形式

给定由d个属性描述的示例$x=(x_1,x_2,...,x_d)$，其中$x_i$是x在第***i***个属性上的取值，线性模型试图学得一个通过属性的线性组合来进行预测的函数，即：
$$
f(x)=w_1x_1+w_2x_2+...+w_dx_d+b
$$
一般向量形式写成：
$$
f(x)=w^Tx+b
$$

该式子的关键在于找到适合的***w***和***b***使得***f(x)***与实际值***y***之间的差距最小。

基于均方误差最小化来进行模型求解的方法称为“最小二乘法”。在线性回归中，最小二乘法就是试图找到一条直线，使所有样本到直线上的欧式距离之和最小。
$$
(w^*, b^*)=min_{(w,b)}\sum_{i=1}^m(f(x_i)-y_i)^2\\
=min_{(w,b)}\sum_{i=1}^m(y_i-wx_i-b)^2
$$
$w^*,b^*$表示$w$和$b$的解。

求解$w$和$b$使$E_(w,b)=\sum_{i=1}^m(y_i-wx_i-b)^2$最小化的过程，称为线性回归模型的最小二乘“参数估计”。这里$E_(w,b)$是关于$w$和$b$的凸函数，当它关于$w$和$b$的导数均为0时，得到$w$和$b$的最优解。

**凸函数**：对区间***[a, b]***上定义的函数***f***，若它对区间中任意两点$x_1$，$x_2$均有$f(\frac{x_1+x_2}{2})\leq \frac{f(x_1)+f(x_2)}{2}$，则称***f***为区间***[a,b]***上的凸函数。

U形曲线的函数如$f(x)=x^2$，通常是凸函数。

对实数集上的函数，可通过求二阶导数来判别：若二阶导数在区间上非负，则称为凸函数；若二阶导数在区间上恒大于0，则称为严格凸函数。

我们可以对$E_(w, x)$分别对$w$和$b$求导，得到：
$$
\frac{\partial E_{(w,x)}}{\partial w}=(\sum_{i=1}^m(y_i-wx_i-b)^2)'\\
=\sum_{i=1}^m((y_i-wx_i-b)(y_i-wx_i-b))'\\
=\sum_{i=1}^m(y_i^2-wx_iy_i-by_i-wx_iy_i+w^2x_i^2+wx_ib-by_i+wx_ib+b^2)'\\
=\sum_{i=1}^m(y_i^2-2wx_iy_i-2by_i+w^2x_i^2+2wx_ib+b^2)'\\
=\sum_{i=1}^m(0-2x_iy_i-0+2wx_i^2+2x_ib+0)\\
=\sum_{i=1}^m(-2x_iy_i+2wx_i^2+2x_ib)\\
=2\sum_{i=1}^m(wx_i^2-(y-b)x_i)\\
=2(\sum_{i=1}^mwx_i^2-\sum_{i=1}^m(y-b)x_i)
$$

$$
\frac{\partial E_{(w,x)}}{\partial b}=(\sum_{i=1}^m(y_i-wx_i-b)^2)'\\
=\sum_{i=1}^m((y_i-wx_i-b)(y_i-wx_i-b))'\\
=\sum_{i=1}^m(y_i^2-wx_iy_i-by_i-wx_iy_i+w^2x_i^2+wx_ib-by_i+wx_ib+b^2)'\\
=\sum_{i=1}^m(y_i^2-2wx_iy_i-2by_i+w^2x_i^2+2wx_ib+b^2)'\\
=\sum_{i=1}^m(0-0-2y_i+0+2wx_i+2b)\\
=\sum_{i=1}^m(2b-(2y-2wx_i))\\
=2(mb-\sum_{i=1}^m(y-wx_i))
$$

令公式（4）和公式（5）为0可得到：
$$
w=\frac{\sum_{i=1}^my_i(x_i-\frac{1}{m}\sum_{i=1}^mx_i)}{\sum_{i=1}^mx_i^2-\frac{1}{m}(\sum_{i=1}^mx_i)^2}
$$

$$
b=\frac{1}{m}\sum_{i=1}^m(y_i-wx_i)
$$

